(function(e,t,n){"use strict";function m(){}function g(e){throw new Error(e)}function y(e){return e instanceof ArrayBuffer||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function b(e){return e instanceof ArrayBuffer?ArrayBuffer:e instanceof Int8Array?Int8Array:e instanceof Uint8Array?Uint8Array:e instanceof Int16Array?Int16Array:e instanceof Uint16Array?Uint16Array:e instanceof Int32Array?Int32Array:e instanceof Uint32Array?Uint32Array:e instanceof Float32Array?Float32Array:e instanceof Float64Array?Float64Array:n}function w(e,t){return e.buffer[t]}function E(e,t,n){e.buffer[t]=n}function O(e,t){var n=arguments.length,r,i,s,o;if(1===n)Array.isArray(e)&&(r=e.length,i=e[0].length,s=r*i+L,o=e);else{if(2!==n)throw new Error("invalid constructor invocation");r=e,i=t,s=r*i+L}var u=new ArrayBuffer(s*A),a=new k(u,L*A);E(a,S,i);if(o)for(var f=0;f<r;++f){var l=o[f];if(l.length!==i)throw new Error("invalid constructor invocation");a.set(o[f],f*i)}return a}function M(e){var t=arguments.length;if(1===t){++e;var n=new O(e,e);E(n,x,N);for(var r=0,i=e;r<i;++r)n[r*e+r]=1;return n}throw new Error("invalid constructor invocation")}function _(e){var t=arguments.length;if(1===t){if(Array.isArray(e)||y(e)){var n=new O(e.length,1);return n.set(e),n}return new O(e,1)}throw new Error("invalid constructor invocation")}function D(){var e=arguments.length;if(0===e)return new _(4);if(4===e)return new _(arguments[0],arguments[1],arguments[2],arguments[3]);throw new Error("invalid constructor invocation")}function P(e,t,r){var i=e.length===t.length?e.length:n,s=w(e,S)===w(t,S)?w(e,S):n;if(n===i)throw new Error("arrays are not the same size");if(n===s)throw new Error("arrays have mismatched dimensions");r=r||new O(i/s,s);for(var o=0,u=i;o<u;++o)r[o]=e[o]+t[o];return r}function H(e,t,r){var i=e.length===t.length?e.length:n,s=w(e,S)===w(t,S)?w(e,S):n;if(n===i)throw new Error("arrays are not the same size");if(n===s)throw new Error("arrays have mismatched dimensions");r=r||new O(i/s,s);for(var o=0,u=i;o<u;++o)r[o]=e[o]-t[o];return r}function B(e,t,r){r=n!==r?r:1e-6;if("number"==typeof e&&"number"==typeof t)return u(e-t)<=r;if(w(e,S)!==w(t,S))return!1;var i=e.length===t.length?e.length:n;if(n===i)return!1;for(var s=0,o=i;s<o;++s)if(u(e[s]-t[s])>r)return!1;return!0}function j(e){var t=e.length,n=0;for(var r=0,i=t;r<i;++r)n+=e[r]*e[r];return o(n)}function F(e){var t=e.length,n=0;for(var r=0,i=t;r<i;++r)n+=e[r]*e[r];return n}function I(e,t){t=n===t?0:t;var r=e.length;for(var i=0,s=r;i<s;++i)e[i]=t;return e}function q(e,t,n){var r=e.length,i=w(e,S);n=n||new O(r/i,r);for(var s=0,o=r;s<o;++s)n[s]=n[s]*t;return n}function R(e,t){var n,r;y(t)?(n=t.length,r=t):(n=t,r=new _(n));for(var i=0,s=n;i<s;++i)r[i]=e;return r}function U(e){var t,n,r,i;if(y(e)){t=w(e,S);if(e.length/t!==t)throw new Error("matrix is not square");n=e;for(r=0,i=e.length;r<i;++r)n[r]=0}else t=e,n=new O(t,t);for(r=0;r<t;++r)n[r*t+r]=1;return n}function z(e){return e?(e[0]=0,e[1]=0,e[2]=0,e[3]=1):(e=new D,e[0]=1),e}function W(e){var t=e.length,n=arguments.length-1;if(n<t)throw new Error("insufficient elements for size: "+t);for(var r=0,i=t;r<i;++r)e[r]=arguments[r+1];return e}function X(e,t){var r=e.length===t.length?e.length:n;if(n===r)throw new Error("vectors are not the same size");var i=0;for(var s=0,o=r;s<o;++s)i+=e[s]*t[s];return i}function V(e,t){var n=e.length;t=t||new _(n);for(var r=0,i=n;r<i;++r)t=-1*e[r];return t}function $(e,t,n){var r=e.length;n=n||new _(r);for(var i=0,s=r;i<s;++r){if(e[i]===0)continue;var o=u(e[i]),a=e[i]>0?1:-1;o>t?n[i]=a*t:n[i]=e[i]}return e}function J(e,t){var n=e.length,r=w(e,S);t=t||new O(n/r,n);for(var i=0,s=n;i<s;++i)t[i]=e[i];return t}function K(e,t){var n=e.length;t=t||new _(n);var r=0,i;for(i=0;i<n;++i)r+=e[i]*e[i];r=o(r);for(i=0;i<n;++i)t[i]=t[i]/r;return t}function Q(e,t){var r=e.length===t.length?e.length:n;if(n===r)throw new Error("vectors are not the same size");var i,s=0;for(var u=0,a=r;u<a;++u)i=e[u]-t[u],s+=i*i;return o(s)}function G(e,t){var r=e.length===t.length?e.length:n;if(n===r)throw new Error("vectors are not the same size");var i=0;for(var o=0,u=r;o<u;++o)i+=e[o]*t[o];return s(i)}function Y(e,t,r,i){var s=e.length===t.length?e.length:n;if(n===s)throw new Error("vectors are not the same size");i=i||new _(s);for(var o=0,u=s;o<u;++o)i[o]=e[o]+r*(t[o]-e[o]);return i}function Z(e,t,n,r){r=r||new _(n);for(var i=t,s=n;i<s;++i)r[i]=e[i]}function et(e,t,r){var i=e.length===t.length?e.length:n;if(n===i)throw new Error("vectors are not the same size");r=r||new _(i);var s=0,u;for(u=0;u<i;++u)r[u]=t[u]-e[u],s+=r[u]*r[u];s=1/o(s);for(u=0;u<i;++u)r[u]=r[u]*s;return r}function tt(e,t,n){return e=e<t?t:e,e=e>n?n:e,e}function nt(e,t,n){n=n||new _(3);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-u*s,n[1]=s*o-a*r,n[2]=r*u-o*i,n}function rt(e,t,n,r,i){}function it(e){var t=e.length,n=w(e,S),r=t/n,i="<mfenced><mtable>";for(var s=0;s<r;++s){i+="<mtr>";for(var o=0;o<n;++o)i+="<mtd><mn>",i+=e[s*n+o],i+="</mn></mtd>";i+="</mtr>"}return i+="</mtable></mfenced>",i}function st(e){}function ot(e,t,n){if(!n)n=new _(t);else if(n.length!==t)throw new Error("result has incorrect length "+n.length+", expected "+t);for(var r=0,i=t;r<i;++r)n[r]=0;return n[e]=1,n}function ut(e,t){t=t||new D;var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,u;return 0===o?(t[0]=0,t[1]=0,t[2]=0,t[3]=0):(u=1/o,t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=-s*u),t}function at(e,t){return t=t||new D,t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function ft(e,t){var n=e.length,r=w(e,S),i;if(n/r!==r)throw new Error("matrix is not square");for(var s=0,o=r-2;s<=o;++s)for(var u=s+1,a=r-1;u<=a;++u)i=e[s*r+u],e[s*r+u]=e[u*r+s],e[u*r+s]=i}function lt(e,t,n){var r=e.length,i=t.length,s=w(e,S),o=w(t,S);if(s!==i/o)throw new Error("arguments have mismatched rows and columns");var u=r/s,a=s,f=o,l,c;if(n){var h=n.length,p=w(n,S);if(h!==u*f||p!==f)throw new Error("result has mismatched dimensions");e===n?(C.set(e),l=C,c=t):t===n&&(l=e,C.set(t),c=C)}else n=new O(u,f),l=e,c=t;var d;for(var v=0;v<u;++v)for(var m=0;m<f;++m){d=0;for(var g=0;g<a;++g)d+=l[a*v+g]*c[f*g+m];n[f*v+m]=d}return n}function ct(e,t){var n=e.length,r=w(e,S);if(n/r!==r)throw new Error("matrix is not square");t=t||new O(r,r);var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,E,x,T,N,C,k,L,A,M,_,D,P,H,B;if(3===r){i=e[0],s=e[1],o=e[2],a=e[3],f=e[4],l=e[5],h=e[6],p=e[7],d=e[8],E=d*f-l*p,x=-d*a+l*h,T=p*a-f*h,H=i*E+s*x+o*T;if(!H)throw new Error("matrix is not invertible");B=1/H,t[0]=E*B,t[1]=(-d*s+o*p)*B,t[2]=(l*s-o*f)*B,t[3]=x*B,t[4]=(d*i-o*h)*B,t[5]=(-l*i+o*a)*B,t[6]=T*B,t[7]=(-p*i+s*h)*B,t[8]=(f*i-s*a)*B}else{if(4!==r)throw new Error("matrix must have dimension 3 or 4");i=e[0],s=e[1],o=e[2],u=e[3],a=e[4],f=e[5],l=e[6],c=e[7],h=e[8],p=e[9],d=e[10],v=e[11],m=e[12],g=e[13],y=e[14],b=e[15],E=i*f-s*a,x=i*l-o*a,T=i*c-u*a,N=s*l-o*f,C=s*c-u*f,k=o*c-u*l,L=h*g-p*m,A=h*y-d*m,M=h*b-v*m,_=p*y-d*g,D=p*b-v*g,P=d*b-v*y,H=E*P-x*D+T*_+N*M-C*A+k*L;if(!H)throw new Error("matrix is not invertible");B=1/H,t[0]=(f*P-l*D+c*_)*B,t[1]=(-s*P+o*D-u*_)*B,t[2]=(g*k-y*C+b*N)*B,t[3]=(-p*k+d*C-v*N)*B,t[4]=(-a*P+l*M-c*A)*B,t[5]=(i*P-o*M+u*A)*B,t[6]=(-m*k+y*T-b*x)*B,t[7]=(h*k-d*T+v*x)*B,t[8]=(a*D-f*M+c*L)*B,t[9]=(-i*D+s*M-u*L)*B,t[10]=(m*C-g*T+b*E)*B,t[11]=(-h*C+p*T-v*E)*B,t[12]=(-a*_+f*A-l*L)*B,t[13]=(i*_-s*A+o*L)*B,t[14]=(-m*N+g*x-y*E)*B,t[15]=(h*N-p*x+d*E)*B}return t}function ht(e,t,n,i){i=i||new D;var a=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],f,l,c,h;return u(a)>=1?(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i):(f=s(a),l=o(1-a*a),u(l)<.001?(i[0]=e[0]*.5+t[0]*.5,i[1]=e[1]*.5+t[1]*.5,i[2]=e[2]*.5+t[2]*.5,i[3]=e[3]*.5+t[3]*.5,i):(c=r((1-n)*f)/l,h=r(n*f)/l,i[0]=e[0]*c+t[0]*h,i[1]=e[1]*c+t[1]*h,i[2]=e[2]*c+t[2]*h,i[3]=e[3]*c+t[3]*h,i))}function dt(e,t){t=t||new D;var n=j(e)/2,s=K(e,pt),o=r(n);return t[0]=s[0]*o,t[1]=s[1]*o,t[2]=s[2]*o,t[3]=i(n),t}function vt(e,t){t=t||new _(3);var n=e[3],r=2*s(n),i=o(1-n*n);return 0===i?(ot(2,3,t),t):(i=1/i,t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t)}function mt(e,t){return t=t||new O(2,2),t[0]=i(e),t[1]=-r(e),t[2]=r(e),t[3]=i(e),t}function gt(e){return f(e[2],e[0])}function yt(e){var t=1e5;e=c(e*t)/t;if(0===e)return"0";var n=1,r=1,i=1,s=1e5;while(n!=e&&s-->0)n<e?r+=1:(i+=1,r=parseInt(e*i,10)),n=r/i;return r+"/"+i}function bt(e){e/=p;var t=yt(e),n=t;return"0"!==t&&(n+=d),n}function wt(e,t,n,r,i,s){}function xt(e,t,n){var r,i,s,o;N===w(e,x)?(r=s=e,i=t):N===w(t,x)&&(r=o=t,i=e);var u=w(r,S)-1;n=n||new M(u+1);if(N===w(i,x))return lt(e,t,n),n;var a;return 3===u?(a=St,U(a),a[3]=i[0],a[7]=i[1],a[11]=i[2]):2===u&&(a=Et,U(a),a[2]=i[0],a[5]=i[1]),n=n||new M(u+1),s?o=a:s=a,lt(s,o,n),n}function Tt(e,t){t=t||new O(3,3);var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n,u=r*r,a=i*i;return t[0]=1-2*u-2*a,t[1]=2*n*r-2*i*s,t[2]=2*n*i+2*r*s,t[3]=2*n*r+2*i*s,t[4]=1-2*o-2*a,t[5]=2*r*i-2*n*s,t[6]=2*n*i-2*r*s,t[7]=2*r*i+2*n*s,t[8]=1-2*o-2*u,t}function Ct(e,t){t=t||new O(3,3);var n=j(e)}var r=t.sin,i=t.cos,s=t.acos,o=t.sqrt,u=t.abs,a=t.atan,f=t.atan2,l=t.floor,c=t.round,h=t.PI,p=2*t.PI,d="t",v=typeof exports=="object"&&exports&&typeof global=="object"&&global&&global==global.global&&(e=global)?exports:n,S=0,x=1,T=0,N=1,C=new Float32Array(16),k=Float32Array,L=1,A=k.BYTES_PER_ELEMENT,pt=new _(3),Et=new M(2),St=new M(3),Nt=new _(3),kt=ot(0,2),Lt=ot(1,2),At=ot(0,3),Ot=ot(1,3),Mt=ot(2,3),_t={isTypedArray:y,arrayType:b,Matrix:O,Transform:M,Vector:_,Quaternion:D,Frustum:n,Perspective:n,Orthographic:n,LookAt:n,PI:h,TAU:p,clone:J,add:P,subtract:H,equal:B,clear:I,scale:q,toMathML:it,toString:st,scalar:{clamp:tt,fraction:yt},radians:{toString:bt,fromDegrees:n,toDegrees:n},vector:{length:j,length2:F,set:W,dot:X,negate:V,limit:$,normalize:K,distance:Q,angle:G,lerp:Y,direction:et,extract:Z,zero:R.bind(n,0),one:R.bind(n,1)},vector2:{x:ot.bind(n,0,2),y:ot.bind(n,1,2),u:ot.bind(n,0,2),v:ot.bind(n,1,2)},vector3:{cross:nt,unproject:n,x:ot.bind(n,0,3),y:ot.bind(n,1,3),z:ot.bind(n,2,3)},vector4:{x:ot.bind(n,0,4),y:ot.bind(n,1,4),z:ot.bind(n,2,4),w:ot.bind(n,3,4)},quaternion:{identity:z,inverse:ut,conjugate:at,slerp:ht,rotation:n,toAxisAngle:vt,fromAxisAngle:dt},matrix:{multiply:lt,inverse:ct,transpose:ft,identity:U,extract:wt},matrix2:{toAngle:gt,fromAngle:mt},matrix3:{toQuaternion:n,fromQuaternion:Tt,toAxisAngle:n,fromAxisAngle:n},transform:{translate:xt,rotate:n,scale:n,svd:n,linear:n}};typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e.M=_t,define(function(){return _t})):v?typeof module=="object"&&module&&module.exports==v?(module.exports=_t).M=_t:v.M=_t:e.M=_t})(this,Math);